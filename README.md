# FaceMelody Music Recommendation System with Facial Recognition

# Project Description:
FaceMelody is an innovative web application that combines facial emotion detection with song recommendations. By analyzing the user's facial expressions in real-time, it provides personalized song suggestions that match their emotional state. The provided code defines the structure and styling of the web application, as well as the JavaScript code for updating the song recommendations dynamically. With FaceMelody, users can discover new music that resonates with their emotions and enhances their listening experience.

# Features:
## Facial Emotion Detection: 
FaceMelody uses computer vision techniques to analyze facial expressions and detect emotions such as happiness, sadness, anger, and surprise. This is done by capturing frames from the webcam and applying machine learning algorithms to classify emotions based on facial features.

## Song Recommendations: 
Once the user's emotions are detected, FaceMelody recommends songs that align with their emotional state. These recommendations are based on a pre-defined database of songs and their associated emotional characteristics. The application selects songs that are known to evoke similar emotions in listeners.

## Real-time Updates: 
FaceMelody continuously updates the song recommendations based on the user's changing emotions. It constantly analyzes the facial expressions captured by the webcam and adjusts the recommendations accordingly. This ensures that the suggested songs are always relevant to the user's current emotional state.

# Running the app:
Flask: 
- Run <code>pip install -r requirements.txt</code> to install all dependencies.
- In Spotipy.py enter your credentials generated by your Spotify Developer account in 'auth_manager'.
- Run <code>python app.py</code>

# Dataset:
The dataset used for this project is the famous FER2013 dataset. Models trained on this dataset can classify 7 emotions. The dataset can be found <a href = "https://www.kaggle.com/msambare/fer2013">here</a>.

# Image Processing and Training:
- The images were normalised, resized to (48,48) and converted to grayscale in batches of 64 with help of 'ImageDataGenerator' in Keras API.
- Training took around 13 hours locally for 75 epochs with an accuracy of ~66 %

# Current condition:
The entire project works perfectly fine. Live detection gives good frame rates due to multithreading.

# Project Components:
- Spotipy is a module for establishing connection to and getting tracks from Spotify using Spotipy wrapper.
- haarcascade is for face detection.
- camera.py is the module for video streaming, frame capturing, prediction and recommendation which are passed to main.py.
- main.py is the main flask application file.
- index.html in 'templates' directory is the web page for the application. Basic HTML and CSS.
- utils.py is an utility module for video streaming of web camera with threads to enable real time detection.
- train.py is the script for image processing and training the model.

# Model Implementation 
## Facial Emotion Recognition: 
The system uses a pre-trained convolutional neural network (CNN) model to recognize facial emotions. The model takes an input image of a face and predicts the emotion associated with it. The emotions recognized include anger, disgust, fear, happiness, neutrality, sadness, and surprise.

## Music Recommendation: 
The system recommends music based on the user's detected emotion. Each emotion is associated with a specific music genre or playlist. The system retrieves the corresponding music playlist from a CSV file and presents it to the user.

## Video Streaming: 
The system captures video frames from the user's webcam in real-time. It processes each frame to detect facial emotions and recommends music accordingly. The video streaming is performed using OpenCV, a popular computer vision library.

## Voice Assistant Commands:
Open Spotify
Open devotional songs
Open telugu songs
Open sleepy songs
Open travelling songs
Open hindi sad songs
Open telugu sad songs
Open english sad songs
Open sad songs
Open my playlist
Open dj songs
Open hanuman songs
Open happy songs
Open bhajana songs
Open relaxing songs
Open workout songs
Open party songs
Open punjabi songs
Open cooking songs
Open k-pop songs
Open english songs
Open hindi songs


